import { Result } from '@catalogfi/utils';

export type Secret = {
  secretHash: string;
  secret: string;
};

/**
 * Secret Manager Interface.
 * This interface is used to generate and retrieve secrets and secretHashes.
 * The secret is generated by hashing the signature and the secretHash is generated by hashing the secret.
 */
export interface ISecretManager {
  /**
   * Generates a new master private key.
   * If the master private key already exists, it will return the existing master private key.
   * Else, it will generate a new master private key by hashing a signature generated by signing a message with the wallet client.
   * @returns Master private key
   */
  getMasterPrivKey: () => string;
  /**
   * Generates secret and secretHash by signing the nonce. Secret is generated by hashing the signature and secretHash is generated by hashing the secret.
   * @param nonce
   * @returns {AsyncResult<Secret, string>} secret,secretHash
   */
  generateSecret: (nonce: number) => Result<Secret, string>;
}
